# Backstage Helm quick commands (local chart)

helm upgrade --install backstage /Users/mikesablaze/goldenpath-idp-infra/backstage-helm/charts/backstage \
  --namespace backstage \
  --create-namespace \
  --set catalog.catalogLocation='https://raw.githubusercontent.com/mikeybeezy/goldenpath-idp-infra/main/backstage-helm/catalog/all.yaml'

kubectl rollout restart deployment/backstage -n backstage

# Local chart using values-local.yaml (recommended for dev)
helm upgrade --install backstage /Users/mikesablaze/goldenpath-idp-infra/backstage-helm/charts/backstage \
  -n backstage --create-namespace \
  -f /Users/mikesablaze/goldenpath-idp-infra/backstage-helm/values-local.yaml \
  --set github.accessToken=${GH_TOKEN}

# Upstream chart (if needed)
helm upgrade --install backstage platformers-community/backstage \
  -n backstage --create-namespace \
  --set github.accessToken=${GH_TOKEN} \
  --set catalog.catalogLocation='https://raw.githubusercontent.com/mikeybeezy/goldenpath-idp-infra/main/backstage-helm/catalog/all.yaml'

# Troubleshooting
kubectl logs -n backstage -l app.kubernetes.io/name=backstage -f
helm get values -n backstage backstage
kubectl get configmap -n backstage backstage-app-config -o yaml | rg -n "catalog|locations|target"



Using upstream chart instead of local chart

If you installed platformers-community/backstage without your local values, it won’t see your repo catalog.
Verify with:

helm get values backstage -n backstage


If catalogLocation is missing or still demo, you’re on the upstream defaults.
Catalog not refreshed

After updating values, restart Backstage and “Refresh” the template in the UI, or:
curl -X POST http://localhost:7007/api/catalog/refresh



helm list -n backstage -a

helm upgrade --install backstage \
  /Users/mikesablaze/goldenpath-idp-infra/backstage-helm/charts/backstage \
  -n backstage --create-namespace \
  -f /Users/mikesablaze/goldenpath-idp-infra/backstage-helm/values-local.yaml \
  --set github.accessToken="$GH_TOKEN"
