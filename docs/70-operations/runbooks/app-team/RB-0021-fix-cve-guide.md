---
id: RB-0021-fix-cve-guide
title: 'App Team Runbook: Fix CVE Guide'
type: runbook
domain: platform-core
applies_to: []
owner: platform-team
lifecycle: active
exempt: false
risk_profile:
  production_impact: medium
  security_risk: high
  coupling_risk: low
reliability:
  rollback_strategy: not-applicable
  observability_tier: silver
  maturity: 1
schema_version: 1
relates_to:
  - ADR-0096-risk-based-ecr-controls
  - RUNBOOK_REQUEST_ECR_REGISTRY
supersedes: []
superseded_by: []
tags: []
inheritance: {}
status: draft
supported_until: 2028-01-05
version: '1.0'
dependencies:
  - docker
  - aws-ecr
breaking_change: false
---

# App Team Runbook: Fix CVE Guide

**Audience:** Application Teams
**Purpose:** How to fix CVEs (security vulnerabilities) in container images

---

## Overview

ECR automatically scans your images for vulnerabilities (CVEs). When found, you need to fix them within the SLA based on your registry's risk level:

- **High risk:** Critical CVEs must be fixed within 7 days
- **Medium risk:** Critical CVEs must be fixed within 14 days
- **Low risk:** Critical CVEs must be fixed within 30 days

---

## Finding CVEs

### In AWS Console

1. Go to ECR → Your Registry
2. Click on an image tag
3. View "Scan results"
4. See list of CVEs with severity

### Via CLI

```bash
aws ecr describe-image-scan-findings \
  --repository-name my-registry \
  --image-id imageTag=v1.2.3 \
  --region eu-west-2
```

---

## Fixing CVEs

### Step 1: Identify the Vulnerability

Look at the scan results to find:
- Package name (e.g., `openssl`)
- Current version (e.g., `1.1.1`)
- Fixed version (e.g., `1.1.1k`)

### Step 2: Update Your Dockerfile

```dockerfile
# Before
FROM ubuntu:20.04

# After - use newer base image
FROM ubuntu:22.04

# OR update specific package
RUN apt-get update && apt-get upgrade -y openssl
```

### Step 3: Rebuild and Push

```bash
# Rebuild
docker build -t my-app:v1.2.4 .

# Tag
docker tag my-app:v1.2.4 <account>.dkr.ecr.eu-west-2.amazonaws.com/my-registry:v1.2.4

# Push
docker push <account>.dkr.ecr.eu-west-2.amazonaws.com/my-registry:v1.2.4
```

### Step 4: Verify

Wait for scan to complete (automatic), then check results.

---

## Best Practices

- ✅ Use minimal base images (e.g., `alpine`, `distroless`)
- ✅ Keep base images up to date
- ✅ Run `apt-get upgrade` in Dockerfile
- ✅ Scan locally before pushing
- ✅ Use multi-stage builds to reduce attack surface

---

## Troubleshooting

**CVE won't go away:**
- Verify you're using the fixed version
- Some CVEs have no fix yet (accept risk or change package)

**Scan not running:**
- Contact platform team

---

## Support

**Questions?** Contact #platform-team on Slack
