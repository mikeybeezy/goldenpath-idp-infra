Step 1
terraform -chdir=envs/dev init

step 2
terraform -chdir=envs/dev apply \
  -var='cluster_lifecycle=ephemeral' \
  -var='build_id=20250115-02' \
  -var='owner_team=platform-team'

step 3
time \
SKIP_ARGO_SYNC_WAIT=false \
NODE_INSTANCE_TYPE=t3.small \
ENV_NAME=dev \
SKIP_CERT_MANAGER_VALIDATION=true \
COMPACT_OUTPUT=false \
SCALE_DOWN_AFTER_BOOTSTRAP=false \
bash goldenpath-idp-bootstrap.sh goldenpath-dev-eks-20250115-02 eu-west-2

Here’s what that command does, line by line:

time → measures how long the whole command takes.
SKIP_ARGO_SYNC_WAIT=false → wait for the autoscaler Argo app to sync.
NODE_INSTANCE_TYPE=t3.small → required for preflight capacity checks.
ENV_NAME=dev → use gitops/argocd/apps/dev.
SKIP_CERT_MANAGER_VALIDATION=true → skip cert-manager validation.
COMPACT_OUTPUT=false → show full command output.
SCALE_DOWN_AFTER_BOOTSTRAP=false → don’t run Terraform scale-down at the end.
bash goldenpath-idp-bootstrap.sh goldenpath-dev-eks-20250115-02 eu-west-2 → run the bootstrap runner against that cluster name + region.

If you want to run it from envs/dev, use the relative path:
time \
SKIP_ARGO_SYNC_WAIT=false \
NODE_INSTANCE_TYPE=t3.small \
ENV_NAME=dev \
SKIP_CERT_MANAGER_VALIDATION=true \
COMPACT_OUTPUT=false \
SCALE_DOWN_AFTER_BOOTSTRAP=false \
bash ../bootstrap/10_bootstrap/goldenpath-idp-bootstrap.sh goldenpath-dev-eks-20250115-02 eu-west-2


step 4
TTEARDOWN_CONFIRM=true RELAX_PDB=true DRAIN_TIMEOUT=300s HEARTBEAT_INTERVAL=30 \
  TF_DIR=envs/dev REQUIRE_KUBE_FOR_TF_DESTROY=true TF_DESTROY_FALLBACK_AWS=true \
  bash goldenpath-idp-teardown.sh goldenpath-dev-eks-20250115-01 eu-west-2




time \
SKIP_ARGO_SYNC_WAIT=true \
NODE_INSTANCE_TYPE=t3.small \
ENV_NAME=dev \
SKIP_CERT_MANAGER_VALIDATION=true \
COMPACT_OUTPUT=false \
SCALE_DOWN_AFTER_BOOTSTRAP=false \
goldenpath-idp-bootstrap.sh goldenpath-dev-eks-20250115-02 eu-west-2
