---
# ClusterSecretStore for AWS Secrets Manager
# This resource is cluster-scoped and enables ExternalSecrets across all namespaces
# to pull secrets from AWS Secrets Manager using IRSA authentication.
#
# Prerequisites:
#   - external-secrets helm chart deployed
#   - IRSA role created via Terraform (enable_eso_role = true)
#   - ServiceAccount annotated with IAM role ARN
apiVersion: external-secrets.io/v1beta1
kind: ClusterSecretStore
metadata:
  name: aws-secretsmanager
  labels:
    goldenpath.idp/component: external-secrets
    goldenpath.idp/tier: platform
spec:
  provider:
    aws:
      service: SecretsManager
      region: eu-west-2
      auth:
        jwt:
          serviceAccountRef:
            name: external-secrets
            namespace: external-secrets
