id: secret_request_schema
title: Secret Request Schema
type: documentation
status: active
version: "1.0"

required:
  - id
  - title
  - status
  - owner
  - spec

properties:
  id:
    type: string
    description: "Audit ID for the request (e.g. SEC-0001)"
  title:
    type: string
  status:
    type: string
    enum_from: status
  owner:
    type: string
    enum_from: owners
  spec:
    type: object
    required:
      - provider
      - secretType
      - riskTier
      - rotationClass
      - lifecycleStatus
    properties:
      provider:
        type: string
        default: aws-secrets-manager
      secretType:
        type: string
        enum_from: security.secret_types
      riskTier:
        type: string
        enum_from: security.risk_tiers
      rotationClass:
        type: string
        enum_from: security.rotation_classes
      lifecycleStatus:
        type: string
        enum_from: security.lifecycle_status
      ttlDays:
        type: integer
        default: 30
      access:
        type: object
        properties:
          namespace:
            type: string
          k8sSecretName:
            type: string
